# Утилита завершения процессов (v1.0)

## Назначение
PowerShell-скрипт для безопасного завершения процессов на локальных и удаленных компьютерах Windows. Поддерживает мультиметодный доступ и интеллектуальный поиск процессов по частичному совпадению имени. Оптимален для администрирования корпоративных сетей и устранения зависших процессов.

## Основные возможности
- **Гибкий поиск процессов**: Поддержка частичного совпадения имен
- **Кросс-платформенный доступ**: Работа с локальными и удаленными системами
- **Мультиметодное завершение**: Поддержка WMI и WinRM для удаленных ПК
- **Интерактивный интерфейс**: Подтверждение перед завершением процессов
- **Подробная отчетность**: Статистика успешных и неудачных операций
- **Автоматическое повышение прав**: Самозапуск с правами администратора
- **Безопасность**: Проверка доступности целевого компьютера перед выполнением

## Требования
- **ОС**: Windows 7+ / Windows Server 2008 R2+
- **PowerShell**: Версия 3.0+
- **Права**: Локальные административные права
- **Для удаленного доступа**:
  - Доступ хотя бы к одному протоколу: WMI (порт 135) или WinRM (порт 5985)
  - Сетевой доступ к целевым компьютерам
  - Разрешен ICMP-трафик для проверки доступности

## Инструкция по использованию

### Базовый запуск
```powershell
powershell.exe -ExecutionPolicy Bypass -File "stop_process.ps1"
```
(рекомендуется создать ярлык с параметрами: `C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -ExecutionPolicy Bypass -File "\\путь_к_скрипту\stop_process.ps1"`)

### Параметры запуска
Скрипт работает в интерактивном режиме и запрашивает необходимые параметры при запуске:
1. Имя компьютера (ENTER для локального ПК)
2. Имя процесса (можно часть имени)
3. Подтверждение перед завершением

## Примеры использования
```powershell
# Локальное завершение процесса
.\stop_process.ps1
> Введите имя компьютера: [ENTER]
> Введите имя процесса: chrome

# Удаленное завершение процесса
.\stop_process.ps1
> Введите имя компьютера: WS-012
> Введите имя процесса: outlook

# Массовое завершение на нескольких компьютерах
"WS-011", "WS-012", "WS-013" | ForEach-Object {
    .\stop_process.ps1
    > Введите имя компьютера: $_
    > Введите имя процесса: notepad
}
```

## Технические детали

### Методы завершения процессов
1. **Локальный метод**  
   - Используется встроенный `Stop-Process`
   - Принудительное завершение с флагом `-Force`

2. **WMI (удаленный)**  
   - Используется класс `Win32_Process`
   - Метод `Terminate()` для завершения
   - Автоматический откат на WinRM при ошибках

3. **WinRM (удаленный)**  
   - Используется `Invoke-Command` с `Stop-Process`
   - Применяется при недоступности WMI

### Приоритет методов доступа
1. **Локальный доступ**  
   - Используется при указании "." или пустого имени компьютера

2. **WMI**  
   - Основной метод для удаленных компьютеров
   - Требует открытого порта 135 и настроенного DCOM

3. **WinRM**  
   - Резервный метод при недоступности WMI
   - Требует предварительной настройки PSRemoting

### Логирование операций
- Цветная консольная индикация (SUCCESS/WARNING/ERROR)
- Подробная статистика по завершенным процессам
- Рекомендации при возникновении ошибок

## Важные примечания
1. Для работы через **WinRM** должна быть включена соответствующая конфигурация:
   ```powershell
   Enable-PSRemoting -Force
   Set-NetFirewallRule -Name "WINRM-HTTP-In-TCP" -RemoteAddress Any
   ```

2. **Требования WMI**:
   - Включенный DCOM-доступ
   - Открытый порт 135 в файрволе
   - Права администратора на целевом компьютере

3. Особенности работы:
   - Системные процессы могут требовать перезагрузки для полного завершения
   - Некоторые защищенные процессы могут не завершаться
   - Рекомендуется проверять список процессов перед подтверждением

## Поддержка
Для отчетов об ошибках или предложений по улучшению обращайтесь к разработчику.  
Copyright © 2025 Кодельник Максим Сергеевич | MIT License  
Версия: 1.0 (2025-08-04)
